import pandas as pd

file_path = '/Users/lanafi/Downloads/NCVoterRegCounty.xlsx'
df = pd.read_excel(file_path)

county = []
ratio = []


# Iterate over the rows using .iterrows()
for i, row in df.iterrows():
    ratio.append((row['Democratic'])/(row['Total']))
    county.append(row['County'])


# Create a new DataFrame using the lists for County and Percent Democrat
df2 = pd.DataFrame({
    'County': county,
    '%Dem/Total': ratio
})

# Print the results
output_file_path = '/Users/lanafi/Downloads/VoterRegistrationPercentage.xlsx'
df2.to_excel(output_file_path, index=False)

